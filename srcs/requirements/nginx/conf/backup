daemon off;

events {}

http {
	include mime.types;

	upstream php {
		server	wordpress:9000;
	}

	#Redirect traffic from port 80 to port 443
	server {
		listen 80;
		listen [::]:80;
		return 301 https://$host$request_uri;
	}
	server {
		listen 443 ssl; #IPv4
		listen [::]:443 ssl; #IPv6

		ssl_certificate /etc/ssl/certs/nginx-selfsigned.crt;
		ssl_certificate_key /etc/ssl/private/nginx-selfsigned.key;
		ssl_protocols TLSv1.3 TLSv1.2;

		location / {
			root /www/wordpress
		}
		location \.php$ {
			proxy_pass https://php;
			proxy_set_header Host $host;
			proxy_set_header X-Real-IP $remote_addr;
		}
}
